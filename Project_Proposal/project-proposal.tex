%% bare_jrnl_compsoc.tex
%% V1.4a
%% 2014/09/17
%% by Michael Shell
%% See:
%% http://www.michaelshell.org/
%% for current contact information.
%%
%% This is a skeleton file demonstrating the use of IEEEtran.cls
%% (requires IEEEtran.cls version 1.8a or later) with an IEEE
%% Computer Society journal paper.
%%
%% Support sites:
%% http://www.michaelshell.org/tex/ieeetran/
%% http://www.ctan.org/tex-archive/macros/latex/contrib/IEEEtran/
%% and
%% http://www.ieee.org/

%%*************************************************************************
%% Legal Notice:
%% This code is offered as-is without any warranty either expressed or
%% implied; without even the implied warranty of MERCHANTABILITY or
%% FITNESS FOR A PARTICULAR PURPOSE! 
%% User assumes all risk.
%% In no event shall IEEE or any contributor to this code be liable for
%% any damages or losses, including, but not limited to, incidental,
%% consequential, or any other damages, resulting from the use or misuse
%% of any information contained here.
%%
%% All comments are the opinions of their respective authors and are not
%% necessarily endorsed by the IEEE.
%%
%% This work is distributed under the LaTeX Project Public License (LPPL)
%% ( http://www.latex-project.org/ ) version 1.3, and may be freely used,
%% distributed and modified. A copy of the LPPL, version 1.3, is included
%% in the base LaTeX documentation of all distributions of LaTeX released
%% 2003/12/01 or later.
%% Retain all contribution notices and credits.
%% ** Modified files should be clearly indicated as such, including  **
%% ** renaming them and changing author support contact information. **
%%
%% File list of work: IEEEtran.cls, IEEEtran_HOWTO.pdf, bare_adv.tex,
%%                    bare_conf.tex, bare_jrnl.tex, bare_conf_compsoc.tex,
%%                    bare_jrnl_compsoc.tex, bare_jrnl_transmag.tex
%%*************************************************************************


% *** Authors should verify (and, if needed, correct) their LaTeX system  ***
% *** with the testflow diagnostic prior to trusting their LaTeX platform ***
% *** with production work. IEEE's font choices and paper sizes can       ***
% *** trigger bugs that do not appear when using other class files.       ***                          ***
% The testflow support page is at:
% http://www.michaelshell.org/tex/testflow/


\documentclass[10pt,conference,onecolumn,compsoc]{IEEEtran}


\usepackage{hyperref}
\usepackage{enumitem}
\usepackage{float}
\setlist[itemize]{leftmargin=3 cm}
\setlist[enumerate]{leftmargin=3cm}


% *** CITATION PACKAGES ***
%
\ifCLASSOPTIONcompsoc
  % IEEE Computer Society needs nocompress option
  % requires cite.sty v4.0 or later (November 2003)
  \usepackage[nocompress]{cite}
\else
  % normal IEEE
  \usepackage{cite}
\fi
% cite.sty was written by Donald Arseneau
% V1.6 and later of IEEEtran pre-defines the format of the cite.sty package
% \cite{} output to follow that of IEEE. Loading the cite package will
% result in citation numbers being automatically sorted and properly
% "compressed/ranged". e.g., [1], [9], [2], [7], [5], [6] without using
% cite.sty will become [1], [2], [5]--[7], [9] using cite.sty. cite.sty's
% \cite will automatically add leading space, if needed. Use cite.sty's
% noadjust option (cite.sty V3.8 and later) if you want to turn this off
% such as if a citation ever needs to be enclosed in parenthesis.
% cite.sty is already installed on most LaTeX systems. Be sure and use
% version 5.0 (2009-03-20) and later if using hyperref.sty.
% The latest version can be obtained at:
% http://www.ctan.org/tex-archive/macros/latex/contrib/cite/
% The documentation is contained in the cite.sty file itself.



% *** GRAPHICS RELATED PACKAGES ***
%
\ifCLASSINFOpdf
   \usepackage[pdftex]{graphicx}
 
\else
 
\fi

% graphicx was written by David Carlisle and Sebastian Rahtz. It is
% required if you want graphics, photos, etc. graphicx.sty is already
% installed on most LaTeX systems. The latest version and documentation
% can be obtained at: 
% http://www.ctan.org/tex-archive/macros/latex/required/graphics/
% Another good source of documentation is "Using Imported Graphics in
% LaTeX2e" by Keith Reckdahl which can be found at:
% http://www.ctan.org/tex-archive/info/epslatex/
%
% latex, and pdflatex in dvi mode, support graphics in encapsulated
% postscript (.eps) format. pdflatex in pdf mode supports graphics
% in .pdf, .jpeg, .png and .mps (metapost) formats. Users should ensure
% that all non-photo figures use a vector format (.eps, .pdf, .mps) and
% not a bitmapped formats (.jpeg, .png). IEEE frowns on bitmapped formats
% which can result in "jaggedy"/blurry rendering of lines and letters as
% well as large increases in file sizes.
%
% You can find documentation about the pdfTeX application at:
% http://www.tug.org/applications/pdftex









% *** PDF, URL AND HYPERLINK PACKAGES ***
%
\usepackage{url}
% url.sty was written by Donald Arseneau. It provides better support for
% handling and breaking URLs. url.sty is already installed on most LaTeX
% systems. The latest version and documentation can be obtained at:
% http://www.ctan.org/tex-archive/macros/latex/contrib/url/
% Basically, \url{my_url_here}.




\begin{document}

\title{C\# WPF Video Player}
%
%

% received ..."  text while in non-compsoc journals this is reversed. Sigh.

\author{Zachary Rose, Logan Walsh
}

\IEEEtitleabstractindextext{%
\begin{abstract}
Our project is a custom video player as a C\# WPF application. It will allow you to browse to a file, load up a video, and control the playback as needed. AVI, MWV, and MP4 will be supported file types. Those who want more control over their video playback beyond what Windows comes with will find this application useful. 
\end{abstract}

}


% make the title area
\maketitle


\IEEEdisplaynontitleabstractindextext

\IEEEpeerreviewmaketitle



\section{Introduction}


For this project, we plan to make a media player program that offers some features that are unavailable in Windows Media Player. It will include a file browser to select a media file, and it will include the controls for playback such as: play/pause, fast forward/slow down, and skip to different parts of the video, as well as volume controls. 

This project is intended for those who want some finer control over the playback of their video files. Windows Media Player does have the basic features for controlling playback of media, but it leaves much to be desired in customization and more niche functionality. 

Windows Media Player lacks features such as moving forward and backwards a frame at a time, enlarging the video at a key press, and muting the video with a key press. In fact, Windows Media Player lacks keyboard controls entirely. VLC Media Player has these features and more, but it can sometimes feel daunting and over bloated for an average use case. This media player will fit comfortably in the middle between the most casual of users and super users. 

\subsection{Background}

Some useful terminology: 
\begin{itemize}
\item media: in this case, a file containing video and/or sound
\item media player: a program that can playback different media, and it usually allows for some control over different aspects of the playback
\item seeker: something that enables a user to skip to an arbitrary part of a media's duration with a single click, often in the form of a horizontal bar  
\item playback: media is in playback when it is currently being shown to the user  
\item file browser: a user interface to make selecting a file from the system convenient  
\item Windows Media Player: a media player that comes with Windows OS by default. Very bare-bones  
\item VLC Media Player: A popular media player for power users. Comes with a huge amount of customization options.
\item Fullscreen: refers to when the video is scaled up to cover an entire monitor  
\item Aspect Ratio: refers to the ratio between the width and height in pixels
\end{itemize}

We decided to make a media player because we thought it would be interesting to make a tool that we might actually use, rather than some project for the sake of displaying some unusual programming concept. It will be good practice towards developing a user interface for a user-oriented application. 

\subsection{Impacts}

Our hope is that this project will become a useful little tool for those who wish to have a light-weight and customizable media player. For those who want a middle ground between the simplicity of Windows Media Player and the overwhelming power of VLC.

\subsection{Challenges}

Before we started this project, we predicted that the hardest thing would be designing an interface to dynamically change keybindings. It would need a file to store them, the ability to parse and edit said file, and a graphical interface with which the user will change the bindings from within the app. 

However, the biggest challenge ended up being designing the UI and keeping it balanced well, even through changing the size of the window. While WPF provided an easy way to quickly prototype a user interface, it was difficult to design something that was appealing. 
\section{Scope}

%Basic goals for getting started: You can load up a video, play and pause it using buttons, and it can be replayed. 

The project will be done once the program runs without any issues and has enough features to differentiate it from Windows Media Player. In other words, the ability to control the video playback with the keyboard and to create custom keybindings. 

We think that this is a worthwhile project because it has practical use, and it will allow us to make further use of the WPF framework. It will require an attractive interface and different form elements working together behind the scenes. 

Basic Goals:
\begin{itemize}
\item Can load a video file to prepare for playback.
\item Can control playback through both mouse and keyboard. 
\item Supports AVI, MKV, and MP4 filetypes. 
\end{itemize}

Stretch Goals:
\begin{itemize}

\item Permanent customization for key bindings, with the ability to reset to defaults. 
\item Combining multiple files into a playlist with associated skip forward/backwards buttons.
\item WPF window can be resized, with all the elements keeping the same size ratio. 
\end{itemize}

We were able to meet all these goals besides creating a playlist. The interface WPF supplies for selecting multiple files at once was undesirable, and due to time constraints we couldn't find or develop an alternative.

\subsection{Requirements}
The functional requirements for a media player are straight forward for anyone who has used one before. We considered what we want to be able to do when watching a video, as well as what is absolutely necessary to do so. Loading a file is the absolute base requirement, but we've come to expect things like pausing and fast forwarding.

\subsubsection{Functional}
\begin{itemize}
\item User can play video files
\item User can use video timeline to skip to desired part of video directly
\item Application supports fullscreen playback 
\item User can pause and unpause the playback at will
\item Application supports different playback speeds, between -2x and 2x
\item User can change the volume as desired
\end{itemize}


\subsubsection{Non-Functional}
\begin{itemize}
\item Application must be able to edit and reload keybindings between different sessions. 
\item Application must be able to load and play several videos sequentially without performance loss.
\end{itemize}

\subsection{Use Cases}
\begin{center}
Use cases quick reference:
\begin{tabular}{c | c}
Use Case \#: & Short description \\
\hline
1 & Loading up a video \\
2 & Editing keybindings \\
3 & Controlling playback \\
\end{tabular}
\end{center}

\begin{itemize}
\item[Use Case Number:] 1
\item[Use Case Name:] Loading up a video
\item[Description:] The user wants to load a video from their hard drive to prepare for playback.
\end{itemize}

\begin{enumerate}
\item User opens up file browsing menu by left-clicking ``File," followed by ``Load File" (See Figure \ref{FileSearchInterface}).
\item User navigates to desired video and selects it.
\item[Termination Outcome:] Video is loaded and begins playback.
\end{enumerate}

%Alternative: User wishes to load a video using a file path
%\begin{enumerate}
%\item User enters file path into search bar (See Figure \ref{FileSearchMockup}).
%\item User left-clicks ``OK" button.
%\item[Termination Outcome:] Video is paused and prepared for playback.
%\end{enumerate}

Note: File selected doesn't exist.
\begin{enumerate}
\item User selects a file that doesn't exist, doesn't have permissions to play, or isn't a valid video format.
\item[Termination Outcome:] Application requests a valid file and allows for re-entry. 

\end{enumerate}
\begin{itemize}
\item[Use Case Number:] 2
\item[Use Case Name:] Editing keybindings
\item[Description:] The user wants to change the default keyboard bindings for different aspects of playback control and expects these changes to persist through different sessions of using the application.
\end{itemize}

\begin{enumerate}
\item User opens up the options by left-clicking the ``Options" tab with the mouse See \ref{OptionsInterface}.
\item User selects ``Set Hotkeys" by left-clicking with the mouse.
\item User clicks the button corresponding to the binding they want to change, and presses the desired keyboard key. See /ref{KeybindingsInterface}.
\item[Termination Outcome:] New keybindings are set for any available functionality, and the new bindings will be saved to a file for automatic loading upon opening the application, should the user choose to save them.
\end{enumerate}

\begin{itemize}
\item[Use Case Number:] 3
\item[Use Case Name:] Controlling playback
\item[Description:] During playback, the user wants to control different aspects of the playback. See Figure \ref{PlayerInterface} for the buttons available to left-click. 
\end{itemize}

\begin{enumerate}
\item User pauses and unpauses playback by left-clicking the pause button. 
\item User increases and decreases playback speed using the corresponding buttons.
\item Alternative: User enters a valid playback speed directly into the text box (between -2 and 2).
\item User increases and decreases volume by dragging the volume slider using the mouse.
\item User enters fullscreen mode by left-clicking the fullscreen button.
\item[Termination Outcome:] Video is in playback in the way desired by the user.
\end{enumerate}

Alternative: User wishes to use keybindings to control video playback. See Figure \ref{KeybindingsInterface}.
\begin{enumerate}
\item User pauses and unpauses playback by pressing the bound button on the keyboard.
\item User increases and decreases playback speed by pressing the bound buttons on the keyboard.
\item User increases and decreases volume by pressing the bound buttons on the keyboard.
\item User enters fullscreen mode by pressing the bound button on the keyboard.
\item[Termination Outcome:] Video is in playback in the way desired by the user.
\end{enumerate}


\subsection{Interface}

Upon opening the media player, the user sees the player awaiting input (See \ref{PlayerInterface}). From here they may wish to load a media file, which they do through the Load File interface (See \ref{FileSearchInterface}). This opens the Windows file search utility and makes selecting a media file simple.\par
Next, the user may wish to choose from several available customization options under the ``Options" menu (See \ref{OptionsInterface}). There are four themes to choose from, which change the color and overall appearance of the media player window. The user can also toggle between stretching the media to fit the window and the media maintaining its aspect ratio with the ``Stretch Aspect Ratio" option. Finally, the user can choose to edit their keybindings under ``Set Hotkeys", which opens a new window. \par
In the Keybindings window (See \ref{KeybindingsInterface}), the user can set their desired keyboard buttons to control the media player in addition to using the mouse. See Use Case 2 for a more detailed explanation.

\begin{figure}[H]
\begin{center}
\includegraphics[scale=1.2]{FileSearchInterface.png}
\caption{Sample of interface for selecting video file}
\label{FileSearchInterface}
\end{center}
\end{figure}
\begin{figure}[H]
\begin{center}
\includegraphics[scale=.7]{PlayerInterface.png}
\caption{Sample of interface before a video is in playback}
\label{PlayerInterface}
\end{center}
\end{figure}


\begin{figure}[H]
\begin{center}
\includegraphics[scale=.7]{OptionsInterface.png}
\caption{Several options are available in the options menu}
\label{OptionsInterface}
\end{center}
\end{figure}

\begin{figure}[H]
\begin{center}
\includegraphics[scale=.7]{KeybindingsInterface.png}
\caption{Window for changing keybindings}
\label{KeybindingsInterface}
\end{center}
\end{figure}

\clearpage
\section{Project Timeline}
This timeline has the dates for every major checkpoint during the development of the media player. The colored bars represent the phases of waterfall development (sans maintenance), and every group work (GW) deliverable is marked as well.
See Figure \ref{timeline}.

\begin{figure}[H]
\begin{center}
\includegraphics[scale=1.5]{Project_Timeline.png}
\caption{Proposed project timeline}
\label{timeline}
\end{center}
\end{figure}

\section{Project Structure}
The Media Player works by updating a Media Element when the user gives input. It is implemented as a MainWindow class containing a MediaElement object, as well as several helping classes to control the appearance. \medskip

Our MainWindow class contains several important features that work together to update the Media Element. A seeker is updated on a timer to remain updated with video playback, and in the same way the video playback is updated when the seeker is moved. A timer is also used to implement playing in reverse; every tick of the timer pushes the media backwards by an amount with respect to the video playback speed.   \par
A Factory class is used to change the appearance of the application during runtime. This was chosen in order to simplify adding more themes by keeping them unbound from the main class. \par
The Keybindings were delegated to their own class, and an associated KeybindingsWindow class to provide the interface with which to change them. 

\subsection{UML Outline}

The MainWindow class holds the WPF form. This form holds the button controls, and most importantly it holds the MediaElement object which is used to enable playback. Two DispatcherTimers are also used to keep the seeker updated with the video playback. These structures are located at the top of Figure \ref{MainUML}.\par
The ThemeFactory is an abstract factory interface used to change the theme of the media player. When choosing a theme a new factory is constructed, and it is used to change the appearance of certain elements like background colors and button design. These structures are located at the bottom of Figure \ref{MainUML}.\par
The Button Decorator is a wrapper for the Windows.Controls.Button with added state and behavior in relation to button appearance. This structure is located at the top of Figure \ref{MainUML}.\par
The Keybinder class is used to dynamically change keybindings during runtime. The MainWindow has a Keybinder, which it used to correctly map the desired keyboard key to a command. The KeybindingsWindow is a separate window that has access to the MainWindows Keybinder object, allowing it to edit it during runtime or write the bindings to a text file.

\begin{figure}[H]
\begin{center}
\includegraphics[scale=0.4]{MediaPlayerUML.png}
\caption{UML of class structure}
\label{MainUML}
\end{center}
\end{figure}

\begin{figure}[H]
\begin{center}
\includegraphics[scale=0.4]{Keybinder.png}
\caption{UML Keybinding class structures}
\label{KeybinderUML}
\end{center}
\end{figure}

\subsection{Design Patterns Used}
We used an abstract factory to provide different look-feel themes for the user to choose from (See Figure \ref{MainUML}). The abstract factory ThemeFactory has two concrete factories: StandardFactory and AdditionalFactory. These concrete factories generate a Light or Dark. Theme is an abstract product which is subclassed by the more specific abstract products Light and Dark. The concrete products Gray, Orange, Night, and Edgy are capable of changing the color of the background and the image/color of the buttons. \medskip

We used a decorator for the Windows.Control.Button to add extra behavior and states to our form elements. The ButtonDecorator has a Type which specifies which button appearance it should have. For instance, a play button vs. a pause button, or a fast forward button. It also has a function SetButtonImage, which is provided a Uri to the correct display image by the concrete product (see the abstract factory above) that calls it. Only the button knows what kind of button it is, so this information is used by the abstract factory to provide the correct file.


\section{Results}
Over the course of working on this project, we've learned many different things. We successfully used waterfall development to plan our work, and we learned the difficulties of developing a larger, longer term project. \par

We developed a media player that competently plays video and audio in an unfamiliar environment. We were able to implement design patterns to help organize class structure and promote decoupling. \par

We weren't able to meet all of our goals. We haven't implemented playing a queue of videos, and we hoped to have far more customization, such as changing the amount of time skipped when jumping forwards and backwards (See \ref{KeybindingsInterface}).

\subsection{Future Work}
This project didn't become anything impressive. We didn't find the time to implement all that we wanted to, so the final project lacks what usefulness we hoped it would have. We don't plan to continue development on this project any further, but we'll take what we learned during development and apply it in the future. If we were to develop something similar in the future, we would use WPF again. It provided built in features that greatly simplified making the user interface, and the built in debugging tools in Visual Studio was useful.



%\begin{thebibliography}{1}

%\bibitem{IEEEhowto:kopka}
%H.~Kopka and P.~W. Daly, \emph{A Guide to \LaTeX}, 3rd~ed.\hskip 1em plus
%  0.5em minus 0.4em\relax Harlow, England: Addison-Wesley, 1999.

%\end{thebibliography}



%\begin{IEEEbiography}{Michael Shell}
%Biography text here.
%\end{IEEEbiography}

% if you will not have a photo at all:
%\begin{IEEEbiographynophoto}{John Doe}
%Biography text here.
%\end{IEEEbiographynophoto}

% insert where needed to balance the two columns on the last page with
% biographies
%\newpage

%\begin{IEEEbiographynophoto}{Jane Doe}
%Biography text here.
%\end{IEEEbiographynophoto}





% that's all folks
\end{document}


